<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Redirection selon groupe</title>
  https://js.arcgis.com/4.29/
</head>
<body>
  <p>Chargement... Veuillez patienter.</p>

  <script>
    require([
      "esri/identity/IdentityManager",
      "esri/portal/Portal"
    ], function(esriId, Portal) {
      esriId.checkSignInStatus("https://https://donneesgeomatique.dev.montreal.ca/portal").then(() => {
        const portal = new Portal.Portal();
        portal.load().then(() => {
          const user = portal.user;
          const groups = user.groups.map(g => g.title);

          if (groups.includes("Créateur")) {
            window.location.href = "https://donneesgeomatique.dev.montreal.ca/portal/apps/experiencebuilder/experience/?id=659f22a8d63346b5b2494307227019df";
          } else if (groups.includes("Éditeur")) {
            window.location.href = "https://ton_portail/apps/experiencebuilder/editeur";
          } else if (groups.includes("Lecteur")) {
            window.location.href = "https://ton_portail/apps/experiencebuilder/lecteur";
          } else {
            document.body.innerHTML = "Aucun accès défini pour votre groupe.";
          }
        });
      });
    });
  </script>
</body>
</html>
